# Entity and the Source of Its Id

* Status: accepted
* Date: 2020-03-16

Technical Story: [#40](https://github.com/pcah/python-clean-architecture/issues/40)

## Context and Problem Statement

* Where from and when an instance of some subtype of Entity do get value of their Id?
* In the context of DDD, an Entity is an object that can be identified by its unique identity only (unique id from the beginning).
* Objects of persistence layer (is it instances of a Model in Django or a SQLAlchemy ) will get their auto id generated upon saving the instance to adequate DB table.
* Two instances of an Entity might be acted upon even before saving it to their DB.
* They would be indistinguishable while not having any identity, equally.

## Considered Options

Where from and when an instance of some subtype of Entity do get value of their Id?

1. from the persistence infrastructure upon saving the instance
2. explicitly given at the moment of construction
3. autogenerated from the moment of construction

## Decision Outcome

Chosen option "3. autogenerated from the moment of construction", because it brings "unique id from the beginning" and keeps Entities independent from coupling with the persistence layer.

### Positive Consequences

* It satisfies the need to identify an instance from the moment of construction.
* Makes Entites (objects of the domain level) independent from all the other layers (from the persistence layer, especially).

### Negative Consequences

* It is harder to guarantee consistency of sequenced values of an Id field. There's no auto-win, when the DB keeps the lock for the value of the id number.
* The default strategy of Entity indexing becomes UUID with is much more verbose (in the meaning of a byte length of the Id value) than auto-incrementing `int`.
